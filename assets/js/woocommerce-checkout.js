function gtmkit_cart(){document.addEventListener("click",function(e){let t=e.target;if(!t||!t.closest("[name=update_cart]"))return!0;gtmkit_cart_quantity_change()}),document.addEventListener("keypress",function(e){let t=e.target;if(!t||!t.closest(".woocommerce-cart-form input[type=number]"))return!0;gtmkit_cart_quantity_change()})}function gtmkit_cart_quantity_change(){document.querySelectorAll(".product-quantity input.qty").forEach(function(e){var t=e.defaultValue;let n=parseInt(e.value);if(t!==(n=isNaN(n)?t:n)){const c=e.closest(".cart_item"),o=c&&c.querySelector(".remove");if(o){const i=JSON.parse(o.getAttribute("data-gtmkit_product_data"));t<n?(i.quantity=n-t,window[datalayer_name].push({event:"add_to_cart",ecommerce:{currency:wc.currency,value:i.price*(n-t),items:[i]}})):(i.quantity=t-n,window[datalayer_name].push({event:"remove_from_cart",ecommerce:{currency:wc.currency,value:i.price*(t-n),items:[i]}}))}}})}function gtmkit_checkout(){0===wc.add_shipping_info.config&&0===wc.add_payment_info.config||(2===wc.add_shipping_info.config&&document.addEventListener("change",function(e){let t=e.target;if(!t||!t.closest("input[name^=shipping_method]")&&!t.closest(".wc-block-components-shipping-rates-control"))return!0;gtmkit_shipping_event()}),2===wc.add_payment_info.config&&document.addEventListener("change",function(e){let t=e.target;if(!t||!t.closest("input[name=payment_method]")&&!t.closest(".wc-block-checkout__payment-method"))return!0;gtmkit_payment_event()}),document.addEventListener("click",function(e){let t=e.target.closest("button");return!t||(!t.classList.contains("wc-block-components-checkout-place-order-button")&&!t.closest("button[name=woocommerce_checkout_place_order]")||(gtmkit_shipping_event(),void gtmkit_payment_event()))}))}function gtmkit_shipping_event(){if(!0!==wc.add_shipping_info.fired){let e;var t=(e=!0===wc.block?(e=document.querySelector(".wc-block-components-shipping-rates-control input[type^=radio]:checked"))||document.querySelector(".wc-block-components-shipping-rates-control input[type^=radio]"):(e=document.querySelector("input[name^=shipping_method]:checked"))||document.querySelector("input[name^=shipping_method]"))?e.value:wc.text["shipping tier not found"];window[datalayer_name].push({event:"add_shipping_info",ecommerce:{currency:wc.currency,value:wc.cart_value,shipping_tier:t,items:wc.cart_items}}),wc.add_shipping_info.fired=!0}}function gtmkit_payment_event(){if(!0!==wc.add_payment_info.fired){let e;var t=(e=!0===wc.block?(e=document.querySelector(".wc-block-checkout__payment-method input[type^=radio]:checked"))||document.querySelector(".wc-block-checkout__payment-method input[type^=radio]"):(e=document.querySelector(".payment_methods input:checked"))||document.querySelector("input[name^=payment_method]"))?e.value:wc.text["payment method not found"];window[datalayer_name].push({event:"add_payment_info",ecommerce:{currency:wc.currency,value:wc.cart_value,payment_type:t,items:wc.cart_items}}),wc.add_payment_info.fired=!0}}