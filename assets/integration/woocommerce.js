function gtmkitLoad(){let s=window.gtmkit_settings.datalayer_name,n,d={"wp-block-handpicked-products":1,"wp-block-product-best-sellers":1,"wp-block-product-category":1,"wp-block-product-new":1,"wp-block-product-on-sale":1,"wp-block-products-by-attribute":1,"wp-block-product-tag":1,"wp-block-product-top-rated":1};document.querySelectorAll(".wc-block-grid .wc-block-grid__product").forEach(function(t){var e=t.closest(".wc-block-grid"),i=t.querySelector(".gtmkit_product_data");if(e&&i){var c,r=e.classList;if(r)for(var o in d)r.contains(o)&&((c=JSON.parse(i.getAttribute("data-gtmkit_product_data"))).item_list_name=window.gtmkit_settings.wc.text[o],c.index=d[o],i.setAttribute("data-gtmkit_product_data",JSON.stringify(c)),d[o]++)}});var t=document.querySelectorAll(".gtmkit_product_data");if(t.length){let e=[],i;t.forEach(function(t){i=JSON.parse(t.getAttribute("data-gtmkit_product_data")),e.push(i)}),window[s].push({ecommerce:null}),window[s].push({event:"view_item_list",ecommerce:{items:e}})}document.addEventListener("click",function(t){t=t.target;let e;if(!t)return!0;if(t.closest(window.gtmkit_settings.wc.css_selectors.product_list_add_to_cart))e="add_to_cart";else{if(!window.gtmkit_settings.wc.wishlist||!t.closest(".products")&&!t.closest(".wc-block-grid__products")||!t.closest(window.gtmkit_settings.wc.css_selectors.product_list_wishlist))return!0;e="add_to_wishlist"}t=t.closest(window.gtmkit_settings.wc.css_selectors.product_list_element),t=t&&t.querySelector(".gtmkit_product_data");if(!t)return!0;t=JSON.parse(t.getAttribute("data-gtmkit_product_data"));t.quantity=1,window[s].push({ecommerce:null}),window[s].push({event:e,ecommerce:{currency:window.gtmkit_data.wc.currency,value:t.price,items:[t]}})},!0),document.addEventListener("click",function(r){r=r.target;if(!r)return!0;let o,i=r.closest("form.cart");if(!i){let t=r.parentNode;for(;!i&&t;)i=t.querySelector("form.cart"),t=t.parentNode}if(!i)return!0;if(r.closest(".single_add_to_cart_button:not(.disabled,.input-needed)"))o="add_to_cart";else{if(!window.gtmkit_settings.wc.wishlist||!r.closest(window.gtmkit_settings.wc.css_selectors.single_product_wishlist))return!0;o="add_to_wishlist"}var r=i.querySelectorAll("[name=variation_id]"),t=i.classList&&i.classList.contains("grouped_form")&&!i.classList.contains("bundle_form");if(r.length){let t=1,e;n&&(r=i.querySelector("[name=quantity]"),n.quantity=r&&r.value||1,t=n.quantity,e=n.price),(n&&"add_to_cart"===o||"add_to_wishlist"===o)&&(window[s].push({ecommerce:null}),window[s].push({event:o,ecommerce:{currency:window.gtmkit_data.wc.currency,value:e*t,items:[n]}}))}else if(t){r=document.querySelectorAll(".grouped_form .gtmkit_product_data");let i=[],c=0;if(r.forEach(function(t){let e=document.querySelectorAll("input[name=quantity\\["+t.getAttribute("data-gtmkit_product_id")+"\\]]");if(e=Number(e[0].value),0===(e=isNaN(e)?0:e)&&"add_to_cart"===o)return!0;0===e&&"add_to_wishlist"===o&&(e=1);t=JSON.parse(t.getAttribute("data-gtmkit_product_data"));t.quantity=e,i.push(t),c+=t.price*t.quantity}),0===i.length)return!0;window[s].push({ecommerce:null}),window[s].push({event:o,ecommerce:{currency:window.gtmkit_data.wc.currency,value:c,items:i}})}else{t=JSON.parse(i.querySelector("[name=gtmkit_product_data]")&&i.querySelector("[name=gtmkit_product_data]").value);t.quantity=i.querySelector("[name=quantity]")&&i.querySelector("[name=quantity]").value,window[s].push({ecommerce:null}),window[s].push({event:o,ecommerce:{currency:window.gtmkit_data.wc.currency,value:t.price*t.quantity,items:[t]}})}},!0),document.addEventListener("click",function(t){var t=t.target;return!t||!t.closest(".mini_cart_item a.remove,.product-remove a.remove")||!(t=JSON.parse(t.getAttribute("data-gtmkit_product_data")))||(window[s].push({ecommerce:null}),void window[s].push({event:"remove_from_cart",ecommerce:{items:[t]}}))},!0),document.addEventListener("click",function(t){var t=t.target,e=t.closest(window.gtmkit_settings.wc.css_selectors.product_list_select_item);if(!e)return!0;if(window.gtmkit_settings.wc.css_selectors.product_list_exclude&&e.closest(window.gtmkit_settings.wc.css_selectors.product_list_exclude))return!0;e=t.closest(window.gtmkit_settings.wc.css_selectors.product_list_element);let i;return!e||!(i=e.querySelector(".gtmkit_product_data"))||void 0===i.getAttribute("data-gtmkit_product_data")||!(t=JSON.parse(i.getAttribute("data-gtmkit_product_data")))||(window[s].push({ecommerce:null}),void window[s].push({event:"select_item",ecommerce:{items:[t]}}))},!0),jQuery(document).on("found_variation",function(t,e){if(void 0!==e){t=t.target;if(t.querySelector("[name=gtmkit_product_data]")){var i,t=JSON.parse(t.querySelector("[name=gtmkit_product_data]")&&t.querySelector("[name=gtmkit_product_data]").value),c=(t.id=t.item_id=window.gtmkit_settings.wc.pid_prefix+e.variation_id,window.gtmkit_settings.wc.use_sku&&e.sku&&""!==e.sku&&(t.id=t.item_id=window.gtmkit_settings.wc.pid_prefix+e.sku),t.price=e.display_price,[]);for(i in e.attributes)c.push(e.attributes[i]);t.item_variant=c.filter(t=>t).join("|"),n=t,0!==window.gtmkit_settings.wc.view_item.config&&(window[s].push({ecommerce:null}),window[s].push({event:"view_item",ecommerce:{currency:window.gtmkit_data.wc.currency,value:t.price,items:[t]}})),!0===window.gtmkit_settings.console_log&&(console.log("GTM Kit: selectedProductVariationData"),console.log(n))}}})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",gtmkitLoad):gtmkitLoad();